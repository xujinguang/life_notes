# 深入理解linux内核
## 第二章 内存管理
### 内存地址
1. 逻辑地址 - 机器语言指令中指定一个指令或操作数的地址，由段+偏移量构成
2. 线性地址 - 32位无符号整数，表示4GB地址，0x00000000 ~ 0xffffffff
3. 物理地址 - 内存芯片的单元地址，对应发送到内存总线上的电位信号

MMU - 逻辑地址->线性地址->物理地址，这是硬件电路
内存仲裁器，处于多CPU，CPU和DMA处理器并发访问内存芯片的仲裁作用

实模式和保护模式
**段选择符**
1. 16位=13位索引 + 1位表示GDT还是LDT中 + 2位请求特权级RPL
2. 存放在段寄存器中，段寄存器：CS，SS，DS，es，fs，gs
3. cs的首两位表示CPL，特权级别。0-代表内核态，3-代表用户态

**段描述符**
1. 8字节
2. 放在GDT，LDT表中
3. GDT每个CPU有一个，LDT属于进程自己；GDT地址由gdtr控制寄存器指向，LDT地址由ldtr寄存器指向
4. 代码段，数据段，系统段

**分段单元**
段寄存器->段选择符->gdtr得到GDT的地址（或者ldtr） + index * 8 获取段描述符 ->从段描述符获得段 + 逻辑地址的偏移量->线性地址

运行在用户态的所有linux进程都使用相同的代码段和数据段，内核也类似。因此有四个通用段。而且段都是从0开始，因此逻辑地址和线性地址就一致了。