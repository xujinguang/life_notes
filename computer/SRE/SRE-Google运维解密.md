# Google运维解密

## 拥抱风险，管理风险
1. 不要追求100%的可靠服务，带来成本增长和限制开发速度
2. SRE旨在寻求快速创新和高效的服务运营业务之间的风险的平衡
3. 我们会努力提高一项服务的可靠性，但不会超过该服务需要的可靠性。
4. 可量化指标：可用性停机时间，请求成功率

## 服务质量目标
1. 如果不详细了解服务中各种行为的重要程度，并且不去度量这些行为的正确性的话，就无法正确运维这个系统，更不要说可靠地运维了
2. SLI/SLA/SLO
    1. SLI - 错误率，吞吐量；在某一个度量时间范围内将原始数据收集起来，计算速率、平均值、百分比等汇总数据。
    2. SLO - 服务的某个SLI的目标值，或者目标范围;SLI≤目标值，或者范围下限≤SLI≤范围上限; 比如RPC请求耗时<100ms
    3. SLA - 指服务与用户之间的一个明确的，或者不明确的协议，描述了在达到或者没有达到SLO之后的后果，比如财务退款或者罚款
3. 经验
    1. 过多过少都不好；过多会干扰真正的指标；过少又起不到作用；四五个具有代表性的指标对系统健康程度的评估和关注就足够了
    2. 可用性、延迟，以及吞吐量：是否能正常处理请求？每个请求花费的时间是多少？多少请求可以被处理？
    3. 延迟、可用性和数据持久性
    4. 吞吐量和端到端延迟
    5. 正确性
4. 数据处理
    1. 收集->汇总
    2. 以一个松散的目标开始，逐渐收紧

## 减少琐事
1. 如果系统正常运转中需要人工干预，应该将此视为一种Bug。
2. 什么是琐事？琐事就是运维服务中手动性的，重复性的，可以被自动化的，战术性，没有持久价值的工作。
3. 是否需要主观性
4. 不超过50%，可以通过值班计算，比如每人只有一天关注值班事项。1/5=20%
5. 琐事的坏处：职业停滞，士气低落，造成误解，进展缓慢，开创先例，促进摩擦，违法承诺
6. 让我们多创新，少干琐事吧！

## 分布式系统监控
1. 4个黄金指标分别是延迟、流量、错误和饱和度 
1. 每当收到紧急警报时，应该立即需要我进行某种操作。每天只能进入紧急状态几次，太多就会导致“狼来了”效应。
2. 每个紧急警报都应该是可以具体操作的。
3. 每个紧急警报的回复都应该需要某种智力分析过程。如果某个紧急警报只是需要一个固定的机械动作，那么它就不应该成为紧急警报。
4. 每个紧急警报都应该是关于某个新问题的，不应该彼此重叠。


## 警示语录
1. 不能将碰运气当成战略!
2. SRE团队成员具有如下特点: （a）对重复性、手工性的操作有天然的排斥感;（b）有足够的技术能力快速开发出软件系统以替代手工操作。
3. SRE团队必须将50%的精力花在真实的开发工作上;SRE团队应该将剩余时间花在研发项目上。
4. SRE团队要承担以下几类职责：可用性改进，延迟优化，性能优化，效率优化，变更管理，监控，紧急事务处理以及容量规划与管理
5. “错误预算”起源于这样一个理念：任何产品都不是，也不应该做到100% 可靠
6. SRE的经验告诉我们，大概 70% 的生产事故由某种部署的变更而触发。
7. 变更管理的最佳实践：渐进式发布；迅速而准确的检测到问题发生；当出现问题时，安全而迅速的回退。
8. Google标准做法是通过一个客观的指标来体现一个待优化的系统属性
9. 如果系统正常运转中需要人工干预，应该将此视为一种Bug。“正常”的定义会随系统的进步而不断改变。
10. 琐事就是运维服务中手动性的，重复性的，可以被自动化的，战术性，没有持久价值的工作。而脏活累活通常具有长期价值，这些也不能算作琐事。
11. 琐事的存在并不总是坏事，但是每个人都必须清楚，在SRE所扮演的角色中，一定数量的琐事是不可避免的，这其实是任何工程类工作都具有的特点。少量的琐事存在不是什么大问题。但是一旦琐事的数量变多，就会有害了。
12. 工程工作（Engineering）是一种新颖的、本质上需要主观判断的工作。它是符合长期战略的，会对你的服务进行长久性的改善的工作。工程工作通常是有创新性和创造性的，着重通过设计来解决问题，解决方案越通用越好
13. Google趋向于使用简单和快速的监控系统配合高效的工具进行事后分析
14. 监控系统应该解决两个问题：什么东西出故障了，以及为什么出故障
15. 监控系统的4个黄金指标分别是延迟、流量、错误和饱和度（saturation）​。
16. 紧急警报的深层理念：每当收到紧急警报时，应该立即需要我进行某种操作。每天只能进入紧急状态几次，太多就会导致“狼来了”效应。● 每个紧急警报都应该是可以具体操作的。● 每个紧急警报的回复都应该需要某种智力分析过程。如果某个紧急警报只是需要一个固定的机械动作，那么它就不应该成为紧急警报。● 每个紧急警报都应该是关于某个新问题的，不应该彼此重叠。 
17. “黑科技”之外，就只剩自动化和机械化了。
18. ，​“与侦探小说不同，缺少刺激、悬念和困惑是源代码的理想特性。​”生产环境中的意外是SRE最大的敌人 
19. SRE推崇保证所有的代码都有必须存在的目的的实践。例如，审查代码以确保它确实符合商业目标，定期删除无用代码，并且在各级测试中增加代码膨胀检测
20. 不是在不能添加更多的时候，而是没有什么可以去掉的时候，才能达到完美
21. 简单的发布流程总的来说要比复杂的发布流程更好。测量和理解单一变化的影响要比同时应对一系列变化更加容易。跟机器学习中的梯度下降法类似。
22. 没有一套设计周全的监控体系就如同蒙着眼睛狂奔
23. 监控系统应该主要从高级服务质量目标层面进行报警，但是也应该保持足够的粒度，可以追踪到某个具体组件。
24. 在有足够数据支撑的时候按步骤解决问题，同时不停地审视和验证目前所有的假设。1. 清晰的问题升级路线;2.清晰定义的应急事件处理步骤;3.无指责，对事不对人的文化氛围。
25. 在应急事件处理结束时，仔细评估哪些地方有问题，哪些地方做得好是非常关键的。而且应该采取措施避免再次发生同样的问题。